<?xml version="1.0" encoding="utf-8" ?>
<commands>
  <command name="Sheet.Query" type="text" connection="local">
    <![CDATA[
SELECT  S.[ID] ,
        U.[ID] AS [UserID] ,
        U.[Name] AS [UserName] ,
        G.[Name] AS [Department] ,
        S.[AuditStatus] ,
        S.[PayStatus] ,
        S.[CustomName] ,
        DD.[Name] AS [Source] ,
        S.[TimeFrom] AS DTimeFrom ,
        D.[Name] AS Base ,
        S.[Total] ,
        S.[Cost] ,
        S.[Received] ,
        S.[Remaining] ,
        S.[Commission] ,
        S.[TaxRate],
        S.[Tax],
        S.[Achievement],
        S.[CreateTime]
FROM    [dbo].[Sheet] AS S
        LEFT JOIN dbo.[User] AS U ON S.UserID = U.ID
        LEFT JOIN dbo.[Dictionary] AS D ON S.Base = D.ID
        LEFT JOIN dbo.[Dictionary] AS DD ON S.[Source] = DD.ID
        LEFT JOIN dbo.[Group] AS G ON G.ID = U.[Group]
WHERE   S.[Deleted] = 0 
  ]]>
  </command>
  <command name="Sheet.Query.GetByID" type="text" connection="local">
    <![CDATA[
SELECT TOP 1 [ID]
      ,[UserID]
      ,[AuditStatus]
      ,[CustomName]
      ,[Contacts]
      ,[Phone]
      ,[QQ]
      ,[WeiXin]
      ,[Address]
      ,[TimeFrom] AS DTimeFrom
      ,[TimeTo] AS DTimeTo
      ,[Base]
      ,[People]
      ,[Source]
      ,[Total]
      ,[Unit]
      ,[Cost]
      ,[TaxRate]
      ,[Tax]
      ,[Remark]
  FROM [dbo].[Sheet] WHERE [ID]=@ID
  ]]>
  </command>
  <command name="Sheet.GetByID" type="text" connection="local">
    <![CDATA[
SELECT TOP 1 [ID]
      ,[UserID]
      ,[AuditStatus]
      ,[TimeFrom]
      ,[TimeTo]
      ,[Base]
      ,[People]
      ,[Source]
      ,[Total]
      ,[Unit]
      ,[Cost]
      ,[Percent]
      ,[Received]
  FROM [dbo].[Sheet] WHERE [ID]=@ID
  ]]>
  </command>
</commands>