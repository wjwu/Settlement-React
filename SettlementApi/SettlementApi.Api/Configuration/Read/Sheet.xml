<?xml version="1.0" encoding="utf-8" ?>
<commands>
  <command name="Sheet.Query" type="text" connection="local">
    <![CDATA[
SELECT  S.[ID] ,
        U.Name AS [ProjectManager] ,
		G.Name AS Department,
        S.[AuditStatus] ,
        S.[PayStatus] ,
        S.[CustomName] ,
		    DD.[Name] AS [Source],
        S.[TimeFrom] AS DTimeFrom ,
        D.[Name] AS Base ,
        S.[TotalPrice] ,
        S.[CostPrice] ,
        S.[ReceivedMoney] ,
        S.[RemainingMoney]
FROM    [dbo].[Sheet] AS S
        LEFT JOIN dbo.[User] AS U ON S.ProjectManager = U.ID
        LEFT JOIN dbo.[Dictionary] AS D ON S.Base = D.ID 
		LEFT JOIN dbo.[Dictionary] AS DD ON S.[Source] = DD.ID
        LEFT JOIN dbo.[Group] AS G ON G.ID = U.[Group]
WHERE   S.[Deleted] = 0 
  ]]>
  </command>
  <command name="Sheet.Query.GetByID" type="text" connection="local">
    <![CDATA[
SELECT TOP 1 [ID]
      ,[CustomName]
      ,[Contacts]
      ,[Phone]
      ,[QQ]
      ,[WeiXin]
      ,[Address]
      ,[TimeFrom] AS DTimeFrom
      ,[TimeTo] AS DTimeTo
      ,[Base]
      ,[People]
      ,[Source]
      ,[TotalPrice]
      ,[UnitPrice]
      ,[CostPrice]
      ,[Remark]
  FROM [dbo].[Sheet] WHERE [ID]=@ID
  ]]>
  </command>
  <command name="Sheet.GetByID" type="text" connection="local">
    <![CDATA[
SELECT TOP 1 [ID]
      ,[TimeFrom]
      ,[TimeTo]
      ,[Base]
      ,[People]
      ,[Source]
      ,[TotalPrice]
      ,[UnitPrice]
      ,[CostPrice]
      ,[ReceivedMoney]
  FROM [dbo].[Sheet] WHERE [ID]=@ID
  ]]>
  </command>
</commands>